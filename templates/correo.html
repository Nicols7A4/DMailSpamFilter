{% extends "layout.html" %}
{% block content %}
<article>
    <header>
        <h2>Asunto: {{ correo.asunto }}</h2>
    </header>
    <p><strong>De:</strong> {{ correo.remitente_email }}</p>
    <p><strong>Para:</strong> {{ correo.destinatario_email }}</p>
    <p><strong>Fecha:</strong> {{ correo.fecha_envio.strftime('%d/%m/%Y %H:%M') }}</p>
    <hr>
    <div>
        <pre style="white-space: pre-wrap; font-family: inherit;">{{ correo.cuerpo }}</pre>
    </div>
</article>

{% if reporte %}
<article>
    <header>
        <h3>An치lisis del Sistema Experto</h3>
    </header>

    <h4>
        Probabilidad de ser SPAM:
        <strong style="color: {{ '#d32f2f' if correo.es_spam else '#388e3c' }};">
            {#-- Solo muestra el porcentaje si el valor no es nulo --#}
            {% if correo.probabilidad_spam is not none %}
            {{ "%.2f"|format(correo.probabilidad_spam * 100) }}%
            {% else %}
            No disponible
            {% endif %}
        </strong>
    </h4>
    <p>El sistema analiza varias caracter칤sticas. Aqu칤 est치n las m치s influyentes para este correo, mostrando c칩mo cada
        una inclin칩 la balanza.</p>

    <table>
        <thead>
            <tr>
                <th>Caracter칤stica Analizada</th>
                <th>Valor Encontrado</th>
                <th>Impacto (Log-Likelihood Ratio)</th>
                <th>Tendencia</th>
            </tr>
        </thead>
        <tbody>
            {% for item in reporte %}
            <tr>
                <td>{{ item.variable.replace('_', ' ')|title }}</td>
                <td>{{ 'S칤' if item.valor == 1 else ('No' if item.valor == 0 else item.valor) }}</td>
                <td>{{ "%.2f"|format(item.log_lr) }}</td>
                <td>{{ '游댮 Hacia SPAM' if item.log_lr > 0 else '游릭 Hacia LEG칈TIMO' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</article>
{% endif %}

<footer>
    <a href="{{ url_for('bandeja') }}" role="button">Volver a Bandejas</a>
</footer>
{% endblock %}